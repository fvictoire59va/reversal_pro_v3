<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reversal Detection Pro v3.0</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/src/styles.css" />
</head>
<body>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- HEADER -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <header class="app-header">
        <div class="header-left">
            <div class="logo">
                <span class="logo-icon">â—†</span>
                <span class="logo-text">REVERSAL PRO</span>
                <span class="logo-version">v3.0</span>
            </div>
            <span class="badge badge-success">NON-REPAINTING</span>
        </div>
        <div class="header-center">
            <div class="symbol-selector">
                <select id="symbolSelect">
                    <option value="BTC/USDT">BTC/USDT</option>
                    <option value="ETH/USDT">ETH/USDT</option>
                    <option value="SOL/USDT">SOL/USDT</option>
                    <option value="BNB/USDT">BNB/USDT</option>
                </select>
            </div>
            <div class="timeframe-buttons" id="timeframeButtons">
                <button class="tf-btn active" data-tf="1m">1m</button>
                <button class="tf-btn" data-tf="5m">5m</button>
                <button class="tf-btn" data-tf="15m">15m</button>
                <button class="tf-btn" data-tf="1h">1H</button>
                <button class="tf-btn" data-tf="4h">4H</button>
                <button class="tf-btn" data-tf="1d">1D</button>
            </div>
        </div>
        <div class="header-right">
            <button class="btn btn-live" id="liveBtn" title="Auto-refresh at timeframe interval">
                <span class="live-indicator"></span>
                LIVE
            </button>
            <button class="btn btn-primary" id="refreshBtn" title="Fetch & Analyze">
                âŸ³ Refresh
            </button>
            <button class="btn btn-outline" id="fetchExchangeBtn" title="Fetch from exchange">
                â†“ Fetch
            </button>
            <button class="btn btn-outline" id="uploadBtn" title="Upload CSV">
                â†‘ CSV
            </button>
            <input type="file" id="csvFileInput" accept=".csv" style="display:none" />
        </div>
    </header>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- CONTROLS BAR -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="controls-bar">
        <div class="control-group">
            <label>Sensitivity</label>
            <select id="sensitivitySelect">
                <option value="Very High">Very High</option>
                <option value="High">High</option>
                <option value="Medium">Medium</option>
                <option value="Low" selected>Low</option>
                <option value="Very Low">Very Low</option>
            </select>
        </div>
        <div class="control-group">
            <label>Signal Mode</label>
            <select id="signalModeSelect">
                <option value="Confirmed Only" selected>Confirmed Only</option>
                <option value="Confirmed + Preview">Confirmed + Preview</option>
                <option value="Preview Only">Preview Only</option>
            </select>
        </div>
        <div class="control-group">
            <label>Bars</label>
            <select id="limitSelect">
                <option value="200">200</option>
                <option value="500" selected>500</option>
                <option value="1000">1000</option>
                <option value="2000">2000</option>
            </select>
        </div>

        <!-- Position Tools -->
        <div class="control-group">
            <button class="btn-tool" id="longToolBtn" title="Long Position Tool">
                â–² LONG
            </button>
            <button class="btn-tool" id="shortToolBtn" title="Short Position Tool">
                â–¼ SHORT
            </button>
            <button class="btn-tool-clear" id="clearPositionBtn" title="Clear Position">
                âœ•
            </button>
        </div>

        <!-- Info panel -->
        <div class="info-panel" id="infoPanel">
            <div class="info-item">
                <span class="info-label">Trend</span>
                <span class="info-value" id="trendValue">â€”</span>
            </div>
            <div class="info-item">
                <span class="info-label">ATR</span>
                <span class="info-value" id="atrValue">â€”</span>
            </div>
            <div class="info-item">
                <span class="info-label">Threshold</span>
                <span class="info-value" id="thresholdValue">â€”</span>
            </div>
            <div class="info-item">
                <span class="info-label">Signals</span>
                <span class="info-value" id="signalsCount">â€”</span>
            </div>
        </div>

        <!-- Position Stats Panel -->
        <div class="position-stats" id="positionStats" style="display: none;">
            <div class="stats-item">
                <span class="stats-label">Entry:</span>
                <span class="stats-value" id="statsEntry">â€”</span>
            </div>
            <div class="stats-item">
                <span class="stats-label">TP:</span>
                <span class="stats-value" id="statsTP">â€”</span>
            </div>
            <div class="stats-item">
                <span class="stats-label">SL:</span>
                <span class="stats-value" id="statsSL">â€”</span>
            </div>
            <div class="stats-item highlight">
                <span class="stats-label">Risk/Reward:</span>
                <span class="stats-value" id="statsRR">â€”</span>
            </div>
            <div class="stats-item">
                <span class="stats-label">Profit:</span>
                <span class="stats-value green" id="statsProfit">â€”</span>
            </div>
            <div class="stats-item">
                <span class="stats-label">Risk:</span>
                <span class="stats-value red" id="statsRisk">â€”</span>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- MAIN CONTENT -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <main class="main-content">
        <!-- Chart container -->
        <div class="chart-wrapper">
            <div id="chartContainer" class="chart-container"></div>
            <!-- Signal detection tooltip -->
            <div id="signalTooltip" class="signal-tooltip" style="display:none;">
                <div class="signal-tooltip-header" id="signalTooltipHeader"></div>
                <div class="signal-tooltip-row">
                    <span class="signal-tooltip-label">DÃ©tection :</span>
                    <span id="signalTooltipDetectedAt" class="signal-tooltip-value"></span>
                </div>
                <div class="signal-tooltip-row">
                    <span class="signal-tooltip-label">DÃ©lai :</span>
                    <span id="signalTooltipDelay" class="signal-tooltip-value"></span>
                </div>
            </div>
            <div id="chartLegend" class="chart-legend">
                <span class="legend-item"><span class="legend-dot dot-ema9"></span>EMA 9</span>
                <span class="legend-item"><span class="legend-dot dot-ema14"></span>EMA 14</span>
                <span class="legend-item"><span class="legend-dot dot-ema21"></span>EMA 21</span>
            </div>
        </div>
    </main>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- AGENT BROKER PANEL -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <section class="agent-broker-panel" id="agentBrokerPanel">
        <!-- Agent Broker Header -->
        <div class="agent-broker-header">
            <div class="agent-broker-title">
                <span class="agent-icon">ðŸ¤–</span>
                <h3>AGENT BROKER</h3>
                <span class="agent-badge" id="activeAgentsBadge">0 active</span>
                <span class="agent-pnl-total" id="totalPnlBadge">PnL: $0.00</span>
            </div>
            <div class="agent-broker-actions">
                <button class="btn btn-outline btn-sm" id="refreshAgentsBtn" title="Refresh agents">
                    âŸ³
                </button>
                <button class="btn btn-primary btn-sm" id="toggleCreateAgent" title="New Agent">
                    + Agent
                </button>
            </div>
        </div>

        <!-- Create Agent Form (hidden by default) -->
        <div class="create-agent-form" id="createAgentForm" style="display: none;">
            <div class="form-row">
                <div class="form-group">
                    <label>Symbol</label>
                    <select id="agentSymbol">
                        <option value="BTC/USDT">BTC/USDT</option>
                        <option value="ETH/USDT">ETH/USDT</option>
                        <option value="SOL/USDT">SOL/USDT</option>
                        <option value="BNB/USDT">BNB/USDT</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Timeframe</label>
                    <select id="agentTimeframe">
                        <option value="1m">1m</option>
                        <option value="5m">5m</option>
                        <option value="15m">15m</option>
                        <option value="1h" selected>1h</option>
                        <option value="4h">4h</option>
                        <option value="1d">1d</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount (â‚¬)</label>
                    <input type="number" id="agentAmount" value="100" min="1" step="10" />
                </div>
                <div class="form-group">
                    <label>Mode</label>
                    <select id="agentMode">
                        <option value="paper" selected>ðŸ“„ Paper</option>
                        <option value="live">ðŸ”´ Live</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Sensitivity</label>
                    <select id="agentSensitivity">
                        <option value="Very High">Very High</option>
                        <option value="High">High</option>
                        <option value="Medium" selected>Medium</option>
                        <option value="Low">Low</option>
                        <option value="Very Low">Very Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Signal Mode</label>
                    <select id="agentSignalMode">
                        <option value="Confirmed Only" selected>Confirmed Only</option>
                        <option value="Confirmed + Preview">Confirmed + Preview</option>
                        <option value="Preview Only">Preview Only</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Bars</label>
                    <select id="agentLimit">
                        <option value="200">200</option>
                        <option value="500" selected>500</option>
                        <option value="1000">1000</option>
                        <option value="2000">2000</option>
                    </select>
                </div>
                <button class="btn btn-primary" id="createAgentBtn">CrÃ©er</button>
                <button class="btn btn-outline" id="cancelCreateAgent">Annuler</button>
            </div>
        </div>

        <!-- Agents List -->
        <div class="agents-list" id="agentsList">
            <!-- Dynamic content -->
        </div>

        <!-- Open Positions Table -->
        <div class="positions-section">
            <div class="positions-header">
                <h4>ðŸ“‹ Positions ouvertes</h4>
            </div>
            <div class="positions-table-wrapper">
                <table class="positions-table" id="positionsTable">
                    <thead>
                        <tr>
                            <th>Agent</th>
                            <th>Side</th>
                            <th>Symbol</th>
                            <th>EntrÃ©e</th>
                            <th>Prix actuel</th>
                            <th>SL</th>
                            <th>TP</th>
                            <th>Qty</th>
                            <th>PnL potentiel</th>
                            <th>Ouverture</th>
                            <th>DurÃ©e</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="positionsBody">
                        <tr class="empty-row">
                            <td colspan="12">Aucune position ouverte</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- STATUS BAR -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <footer class="status-bar">
        <span id="statusText">Ready</span>
        <span id="statusTime"></span>
    </footer>

    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <span>Analyzing...</span>
    </div>

    <script type="module" src="/src/main.js"></script>
</body>
</html>
